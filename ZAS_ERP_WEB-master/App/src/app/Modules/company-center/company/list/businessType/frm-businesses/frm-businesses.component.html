<div class="button-space">
  <button
    type="button"
    class="btn-close close-button"
    aria-label="Close"
    (click)="closeModal()"
  ></button>

  <!-- Header -->
  <div class="header border-bottom mb-3">
    <div class="d-flex gap-3">
      <button
        type="button"
        class="btn btn-link text-decoration-none px-2 py-2 fw-semibold text-primary"
      >
        Business Type Info
      </button>
    </div>
  </div>

  <!-- Body -->
  <div class="card-body">
    <form [formGroup]="businessForm" (ngSubmit)="onSubmit()">
      <h5 class="section-title">
        <i class="bi bi-diagram-3-fill me-2 text-primary"></i> Business Type
        Info
      </h5>

      <div class="row g-3">
        <div class="col-md-3">
          <label class="form-label">
            Business Type Name <span class="text-danger">*</span>
          </label>
          <input
            type="text"
            class="form-control"
            id="businessTypeName"
            formControlName="businessTypeName"
            placeholder="Enter Business Type Name"
            [class.is-invalid]="
              businessForm.get('businessTypeName')?.invalid &&
              businessForm.get('businessTypeName')?.touched
            "
          />
          @if (businessForm.get('businessTypeName')?.touched &&
          businessForm.get('businessTypeName')?.hasError('required')) {
          <div class="invalid-feedback">Business Type Name is required.</div>
          } @if (businessForm.get('businessTypeName')?.touched &&
          businessForm.get('businessTypeName')?.hasError('maxlength')) {
          <div class="invalid-feedback">Must not exceed 100 characters.</div>
          }
        </div>

        <!-- Audit Fields (Only in Edit Mode) -->
        @if (isEdit && business) {
        <div class="col-md-3">
          <label class="form-label">Created By</label>
          <input
            type="text"
            class="form-control"
            [value]="business.createdByUserName || '—'"
            readonly
          />
        </div>

        <div class="col-md-3">
          <label class="form-label">Creation Date</label>
          <input
            type="text"
            class="form-control"
            [value]="
              business.createdDate ? formatPKTDate(business.createdDate) : '—'
            "
            readonly
          />
        </div>

        <div class="col-md-3">
          <label class="form-label">Last Modified By</label>
          <input
            type="text"
            class="form-control"
            [value]="business.lastModifiedByUserName || '—'"
            readonly
          />
        </div>

        <div class="col-md-3">
          <label class="form-label">Last Modified</label>
          <input
            type="text"
            class="form-control"
            [value]="
              business.lastModifiedDate
                ? formatPKTDate(business.lastModifiedDate)
                : '—'
            "
            readonly
          />
        </div>
        }

        <!-- Is Active -->
        <div class="col-md-3 d-flex align-items-center mt-4">
          <div class="form-check form-switch">
            <input
              class="form-check-input"
              type="checkbox"
              id="isActive"
              formControlName="isActive"
            />
            <label class="form-check-label" for="isActive">Active</label>
          </div>
        </div>
      </div>
      <!-- =================== FOOTER SAVE BAR =================== -->
      <div class="footer-bar" (click)="onSubmit()">
        @if (!isLoading && businessForm.valid) {
        <i class="bi {{ isEdit ? 'bi-pencil-square' : 'bi-save' }} me-2"></i>
        {{ isEdit ? "Update" : "Save" }}
        } @else if (isLoading) {
        <span class="spinner-border spinner-border-sm me-2"></span>
        Saving... } @else if (businessForm.invalid && !isLoading) {
        <i class="bi bi-exclamation-triangle me-2"></i>
        Please fill all required fields }
      </div>
    </form>
  </div>
</div>
