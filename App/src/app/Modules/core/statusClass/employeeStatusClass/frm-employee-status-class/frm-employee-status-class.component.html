<div class="button-space">
  <button
    type="button"
    class="btn-close close-button"
    aria-label="Close"
    (click)="closeModal()"
  ></button>

  <div class="header border-bottom mb-3">
    <div class="d-flex gap-3">
      <button
        type="button"
        class="btn btn-link text-decoration-none px-2 py-2 fw-semibold text-primary"
      >
        Employee Status Class Info
      </button>
    </div>
  </div>

  <div class="card-body">
    <form [formGroup]="form" (ngSubmit)="onSubmit()">
      <h5 class="section-title">
        <i class="bi bi-person-badge-fill me-2 text-primary"></i>
        Employee Status Class
      </h5>

      <div class="row g-3">
        <!-- Class Name -->
        <div class="col-md-3">
          <label class="form-label">
            Class Name <span class="text-danger">*</span>
          </label>
          <input
            type="text"
            class="form-control"
            formControlName="className"
            placeholder="Enter Class Name"
            [class.is-invalid]="
              classNameCtrl?.invalid && classNameCtrl?.touched
            "
          />
          <div
            class="invalid-feedback"
            *ngIf="classNameCtrl?.touched && classNameCtrl?.errors?.['required']"
          >
            Class Name is required.
          </div>
          <div
            class="invalid-feedback"
            *ngIf="classNameCtrl?.touched && classNameCtrl?.errors?.['maxlength']"
          >
            Must not exceed 100 characters.
          </div>
        </div>

        <!-- Parent Status Dropdown -->
        <div class="col-md-3">
          <label class="form-label">
            Status <span class="text-danger">*</span>
          </label>
          <select
            class="form-select"
            formControlName="statusId"
            [class.is-invalid]="
              form.get('statusId')?.invalid && form.get('statusId')?.touched
            "
          >
            <option [ngValue]="null">Select Status</option>
            <option *ngFor="let s of statusList" [ngValue]="s.id">
              {{ s.statusName }}
            </option>
          </select>
          <div
            class="invalid-feedback"
            *ngIf="
              form.get('statusId')?.touched &&
              form.get('statusId')?.errors?.['required']
            "
          >
            Status is required.
          </div>
        </div>

        <!-- READ-ONLY AUDIT FIELDS -->
        <ng-container *ngIf="statusClass?.id">
          <div class="col-md-3">
            <label class="form-label">Transaction Type</label>
            <input
              type="text"
              class="form-control"
              [value]="statusClass?.transactionItemType || '-'"
              readonly
            />
          </div>

          <div class="col-md-3">
            <label class="form-label">Created By</label>
            <input
              type="text"
              class="form-control"
              [value]="statusClass?.createdBy || '-'"
              readonly
            />
          </div>

          <div class="col-md-3">
            <label class="form-label">Creation Date</label>
            <input
              type="text"
              class="form-control"
              [value]="formatDate(statusClass?.creationDate)"
              readonly
            />
          </div>

          <div class="col-md-3">
            <label class="form-label">Last Modified By</label>
            <input
              type="text"
              class="form-control"
              [value]="statusClass?.lastModifiedBy || '-'"
              readonly
            />
          </div>

          <div class="col-md-3">
            <label class="form-label">Last Modified Date</label>
            <input
              type="text"
              class="form-control"
              [value]="formatDate(statusClass?.modifiedDate)"
              readonly
            />
          </div>
        </ng-container>
        <!-- Fore Color -->
        <div class="col-md-3">
          <label class="form-label">Fore Color</label>
          <input
            type="color"
            class="form-control form-control-color"
            formControlName="foreColor"
            title="Choose text color"
          />
        </div>
      </div>

      <!-- Toggles -->
      <div class="col-md-3 d-flex align-items-center mt-4">
        <div class="form-check form-switch me-3">
          <input
            class="form-check-input"
            type="checkbox"
            id="isApproved"
            formControlName="isApproved"
          />
          <label class="form-check-label" for="isApproved">Approved</label>
        </div>

        <div class="form-check form-switch">
          <input
            class="form-check-input"
            type="checkbox"
            id="isActive"
            formControlName="isActive"
          />
          <label class="form-check-label" for="isActive">Active</label>
        </div>
      </div>
      <!-- Submit Button -->
      <div
        class="footer-bar btn btn-primary mt-3 d-flex align-items-center justify-content-center"
        [class.disabled]="isLoading || form.invalid"
        (click)="onSubmit()"
      >
        <ng-container *ngIf="!isLoading && form.valid">
          <i class="bi {{ isEdit ? 'bi-pencil-square' : 'bi-save' }} me-2"></i>
          {{ isEdit ? "Update" : "Save" }}
        </ng-container>

        <ng-container *ngIf="isLoading">
          <span class="spinner-border spinner-border-sm me-2"></span>
          Saving...
        </ng-container>

        <ng-container *ngIf="!isLoading && form.invalid">
          <i class="bi bi-exclamation-triangle me-2"></i>
          Please fill all required fields
        </ng-container>
      </div>
    </form>
  </div>
</div>
