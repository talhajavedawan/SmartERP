<div class="d-flex justify-content-center align-items-center vh-100 bg-light">
  <div class="card shadow-lg border-0 rounded-4" style="width: 100%; max-width: 480px;">
    <div class="card-body p-4">
      <h4 class="text-center mb-3 fw-bold text-primary">
        <i class="bi bi-shield-lock me-2"></i> Change Password
      </h4>

      <div class="text-center mb-4" *ngIf="currentUser">
        <div class="fw-semibold fs-6 text-dark">
          {{ currentUser?.userName || 'Administrator' }}
        </div>
        <small class="text-muted">
          {{ currentUser?.email || 'Administrator2244@gmail.com' }}
        </small>
        <hr class="mt-3 mb-2" />
      </div>

      <form [formGroup]="form" (ngSubmit)="submit()" autocomplete="off">
        <!-- OLD PASSWORD -->
        <div class="mb-3">
          <label class="form-label fw-semibold">
            Old Password <span class="text-danger">*</span>
          </label>
          <div class="input-group input-group-lg">
            <span class="input-group-text bg-white"><i class="bi bi-lock-fill text-secondary"></i></span>
            <input
              [type]="showOldPassword ? 'text' : 'password'"
              class="form-control"
              formControlName="oldPassword"
              placeholder="Enter old password"
              autocomplete="new-password"
            />
            <button
              type="button"
              class="btn btn-outline-secondary"
              (click)="showOldPassword = !showOldPassword"
              tabindex="-1"
            >
              <i class="bi" [ngClass]="showOldPassword ? 'bi-eye-slash-fill' : 'bi-eye-fill'"></i>
            </button>
          </div>
          <small class="text-danger" *ngIf="form.get('oldPassword')?.invalid && formSubmitted">
            Old password is required.
          </small>
        </div>

        <!-- NEW PASSWORD -->
        <div class="mb-3">
          <label class="form-label fw-semibold">
            New Password <span class="text-danger">*</span>
          </label>
          <div class="input-group input-group-lg">
            <span class="input-group-text bg-white"><i class="bi bi-key-fill text-secondary"></i></span>
            <input
              [type]="showNewPassword ? 'text' : 'password'"
              class="form-control"
              formControlName="newPassword"
              placeholder="Enter new password"
              autocomplete="new-password"
            />
            <button
              type="button"
              class="btn btn-outline-secondary"
              (click)="showNewPassword = !showNewPassword"
              tabindex="-1"
            >
              <i class="bi" [ngClass]="showNewPassword ? 'bi-eye-slash-fill' : 'bi-eye-fill'"></i>
            </button>
          </div>
          <small class="text-danger" *ngIf="form.get('newPassword')?.invalid && formSubmitted">
            Password must be at least 6 characters long.
          </small>
        </div>

        <!-- CONFIRM PASSWORD -->
        <div class="mb-3">
          <label class="form-label fw-semibold">
            Confirm Password <span class="text-danger">*</span>
          </label>
          <div class="input-group input-group-lg">
            <span class="input-group-text bg-white"><i class="bi bi-check2-circle text-secondary"></i></span>
            <input
              [type]="showConfirmPassword ? 'text' : 'password'"
              class="form-control"
              formControlName="confirmPassword"
              placeholder="Re-enter new password"
              autocomplete="new-password"
            />
            <button
              type="button"
              class="btn btn-outline-secondary"
              (click)="showConfirmPassword = !showConfirmPassword"
              tabindex="-1"
            >
              <i class="bi" [ngClass]="showConfirmPassword ? 'bi-eye-slash-fill' : 'bi-eye-fill'"></i>
            </button>
          </div>
          <small class="text-danger" *ngIf="form.hasError('passwordMismatch') && formSubmitted">
            Passwords do not match.
          </small>
        </div>

        <!-- SUBMIT + CANCEL -->
        <div class="d-flex gap-2 mt-4">
          <button
            type="submit"
            class="btn btn-primary flex-grow-1 fw-semibold shadow-sm"
            [disabled]="isLoading"
          >
            <span *ngIf="!isLoading"><i class="bi bi-save2 me-2"></i>Update Password</span>
            <span *ngIf="isLoading"><i class="bi bi-hourglass-split me-2"></i>Processing...</span>
          </button>
          <button
            type="button"
            class="btn btn-outline-secondary fw-semibold"
            (click)="onCancel()"
          >
            <i class="bi bi-x-circle me-1"></i>Cancel
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
