<div class="button-space">
  <!-- Close Button -->
  <button
    type="button"
    class="btn-close close-button"
    aria-label="Close"
    (click)="onCancel()"
  ></button>

  <div class="card-body">
    <form [formGroup]="cityForm" (ngSubmit)="onSubmit()" class="row g-4">
      <!-- =================== HEADER =================== -->
      <h5 class="section-title mt-2 mb-3">
        <i class="bi bi-buildings-fill text-primary me-2"></i>
        {{ isEdit ? "Update City" : "Add New City" }}
      </h5>

      <!-- =================== CITY INFO =================== -->
      <div class="row g-3 mt-1">
        <!-- ðŸ™ï¸ City Name -->
        <div class="col-md-6">
          <label class="form-label">City Name <span class="text-danger">*</span></label>
          <input
            type="text"
            class="form-control"
            placeholder="Enter city name"
            formControlName="name"
            autocomplete="off"
          />
          <div
            *ngIf="cityForm.get('name')?.invalid && cityForm.get('name')?.touched"
            class="text-danger small"
          >
            Please enter a valid city name.
          </div>
        </div>

        <!-- ðŸŒ Select State -->
        <div class="col-md-6">
          <label class="form-label">Select State <span class="text-danger">*</span></label>
          <mat-form-field appearance="outline" class="w-100">
            <mat-select
              formControlName="stateId"
              placeholder="Select a state"
              panelClass="custom-select-panel"
            >
              <mat-option>
                <ngx-mat-select-search
                  [formControl]="stateFilter"
                  [placeholderLabel]="'Search states...'"
                  [noEntriesFoundLabel]="'No states found'"
                ></ngx-mat-select-search>
              </mat-option>
              <mat-option *ngFor="let state of filteredStates" [value]="state.id">
                {{ state.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <div
            *ngIf="cityForm.get('stateId')?.invalid && cityForm.get('stateId')?.touched"
            class="text-danger small"
          >
            Please select a state.
          </div>
        </div>
      </div>


<!-- =================== FOOTER BAR =================== -->
<div
  class="footer-bar"
  (click)="onSubmit()"
  [class.disabled]="cityForm.invalid || isLoading"
>
  <span *ngIf="!isLoading && !cityForm.invalid">
    <i class="bi bi-save me-2"></i>
    {{ isEdit ? "Update City" : "Save City" }}
  </span>
  <span *ngIf="isLoading">
    <span class="spinner-border spinner-border-sm me-2"></span> Saving...
  </span>
  <span *ngIf="cityForm.invalid && !isLoading" class="opacity-75">
    <i class="bi bi-exclamation-triangle me-2"></i>
    Please fill all required fields
  </span>
</div>
